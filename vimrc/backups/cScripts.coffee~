sheetApp = angular.module "sheet", []

sheetApp.directive "youtube", () ->
    restrict: "E"
    scope: 
        src: "@src"
    template: "<div class='youTubeVideo'><iframe width='800' height='500' frameborder='0' allowfullscreen></iframe></div>"
    link: ($scope, $elem) ->
        $elem.find('iframe').attr('src', $scope.src)

spreadSheetCtrl = ($scope, $parse) ->
    $scope.columns = ['A', 'B', 'C', 'D']
    $scope.rows = [1, 2, 3, 4]
    $scope.cells = {}

    $scope.process = (exp) ->
        if !exp
            return
        else
            exp.replace /[A-Z]\d+/g, (ref) ->
                'compute("#{ref}")'

    $scope.compute = (cellString) ->
        $parse($scope.process($scope.cells[cellString]))($scope)
    return