var sheetApp = angular.module("sheet", []);

sheetApp.directive("youtube",
	function () {
		return {
			restrict: "E",
      scope: {
        src: '@src'
      },
			template: "<div class='youTubeVideo'>" +
						"<iframe width='560' height='315' frameborder='0' allowfullscreen  src=\"\"></iframe>" +
					"</div>",
      link: function($scope, $elem) {
        $elem.find('iframe').attr('src', $scope.src)
      }
		}
	});

spreadSheetCtrl = function ($scope, $parse) {
	$scope.columns = ['A', 'B', 'C', 'D'];
	$scope.rows = [1, 2, 3, 4];
	$scope.cells = {};

	$scope.process = function (exp) {
		if (!exp)
			return;
		return exp.replace(/[A-Z]\d+/g, function (ref) {
			return 'compute("' + ref + '")';
		})
	}

	$scope.compute = function (cellString) {
		return $parse(process($scope.cells[cellString]))($scope);
	};
};
